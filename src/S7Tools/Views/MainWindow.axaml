<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:S7Tools.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="using:Avalonia.Xaml.Interactivity"
        xmlns:views="clr-namespace:S7Tools.Views"
        xmlns:converters="clr-namespace:S7Tools.Converters"
        xmlns:local="clr-namespace:S7Tools"
        mc:Ignorable="d" d:DesignWidth="1024" d:DesignHeight="768"
        x:Class="S7Tools.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="S7Tools"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <i:Interaction.Behaviors>
        <views:CloseApplicationBehavior Interaction="{Binding CloseApplicationInteraction}" />
    </i:Interaction.Behaviors>

    <Grid RowDefinitions="Auto, *, Auto">
        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_Exit" Command="{Binding ExitCommand}" />
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Cut" Command="{Binding CutCommand}" />
                <MenuItem Header="_Copy" Command="{Binding CopyCommand}" />
                <MenuItem Header="_Paste" Command="{Binding PasteCommand}" />
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="Toggle Left Panel" Command="{Binding ToggleLeftPanelCommand}" />
                <MenuItem Header="Toggle Bottom Panel" Command="{Binding ToggleBottomPanelCommand}" />
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <SplitView Grid.Row="1"
                   IsPaneOpen="{Binding IsLeftPanelOpen}"
                   DisplayMode="{Binding LeftPanelDisplayMode}"
                   PanePlacement="Left">
            <SplitView.Pane>
                <Border Background="LightGray" Padding="10">
                    <TextBlock Text="Navigation Panel" />
                </Border>
            </SplitView.Pane>

            <Grid RowDefinitions="*, Auto">
                <!-- Workspace -->
                <ContentControl Grid.Row="0" Content="{Binding ActiveWorkspaceContent}">
                    <ContentControl.ContentTemplate>
                        <DataTemplate>
                            <!-- This is where different views would be loaded -->
                            <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </DataTemplate>
                    </ContentControl.ContentTemplate>
                    <ContentControl.DataTemplates>
                        <local:ViewLocator/>
                    </ContentControl.DataTemplates>
                    <!-- Default content when ActiveWorkspaceContent is null -->
                    <StackPanel Spacing="10" Margin="20" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="{Binding Greeting}" FontSize="24" FontWeight="Bold"/>

                        <Button Content="Read Tag" Command="{Binding ReadTagCommand}" HorizontalAlignment="Center"/>

                        <TextBlock Text="Last Read Tag:" Margin="0,10,0,0"/>
                        <Border Padding="10" BorderBrush="Gray" BorderThickness="1" CornerRadius="4">
                            <StackPanel IsVisible="{Binding LastReadTag, Converter={x:Static converters:ObjectConverters.IsNotNull}}">
                                <TextBlock Text="{Binding LastReadTag.Name, StringFormat='Name: {0}'}"/>
                                <TextBlock Text="{Binding LastReadTag.Address, StringFormat='Address: {0}'}"/>
                                <TextBlock Text="{Binding LastReadTag.Value, StringFormat='Value: {0}'}"/>
                            </StackPanel>
                        </Border>
                        <TextBlock IsVisible="{Binding LastReadTag, Converter={x:Static converters:ObjectConverters.IsNull}}" Text="No tag read yet."/>

                        <TextBox Text="{Binding TestInputText}" Margin="0,20,0,0" Watermark="Text for clipboard..."/>
                    </StackPanel>
                </ContentControl>

                <!-- Bottom Panel -->
                <GridSplitter Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="5" Background="LightGray" />
                <Border Grid.Row="1"
                        Height="{Binding BottomPanelGridLength.Value}"
                        Background="LightGray"
                        Padding="10">
                    <TextBlock Text="Bottom Panel (Logs, Output, etc.)" />
                </Border>
            </Grid>
        </SplitView>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="Gainsboro" Padding="5">
            <TextBlock Text="Ready" />
        </Border>
    </Grid>
</Window>
